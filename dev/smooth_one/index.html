<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>开始使用: 一维光滑流形 · InvariantManifolds.jl</title><meta name="title" content="开始使用: 一维光滑流形 · InvariantManifolds.jl"/><meta property="og:title" content="开始使用: 一维光滑流形 · InvariantManifolds.jl"/><meta property="twitter:title" content="开始使用: 一维光滑流形 · InvariantManifolds.jl"/><meta name="description" content="Documentation for InvariantManifolds.jl."/><meta property="og:description" content="Documentation for InvariantManifolds.jl."/><meta property="twitter:description" content="Documentation for InvariantManifolds.jl."/><meta property="og:url" content="https://Xiaomingzzhang.github.io/InvariantManifolds.jl/smooth_one/"/><meta property="twitter:url" content="https://Xiaomingzzhang.github.io/InvariantManifolds.jl/smooth_one/"/><link rel="canonical" href="https://Xiaomingzzhang.github.io/InvariantManifolds.jl/smooth_one/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="InvariantManifolds.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">InvariantManifolds.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">主页</a></li><li class="is-active"><a class="tocitem" href>开始使用: 一维光滑流形</a></li><li><a class="tocitem" href="../smooth_two/">光滑两维流形</a></li><li><a class="tocitem" href="../non_smooth_one/">非光滑一维流形</a></li><li><a class="tocitem" href="../non_smooth_two/">非光滑两维流形</a></li><li><a class="tocitem" href="../api/">类型与函数</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>开始使用: 一维光滑流形</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>开始使用: 一维光滑流形</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Xiaomingzzhang/InvariantManifolds.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Xiaomingzzhang/InvariantManifolds.jl/blob/master/docs/src/smooth_one.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p>using InvariantManifolds, StaticArrays, OrdinaryDiffEq, CairoMakie</p><pre><code class="nohighlight hljs"># Getting Started: One-Dimensional Smooth Manifolds

## Nonlinear Mapping
Consider the following Henon map:
</code></pre><p>math \begin{aligned} x&#39;&amp;=1-\alpha x^2+y,\
y&#39;&amp;=\beta x, \end{aligned}</p><pre><code class="nohighlight hljs">
where $\alpha,\beta$ are parameters. This mapping has fixed points:
</code></pre><p>math \begin{aligned} (x<em>1,y</em>1)&amp;=(\frac{-\sqrt{4 \alpha +\beta ^2-2 \beta +1}+\beta -1}{2 \alpha },\frac{1}{2} \left(\frac{\beta ^2}{\alpha }-\frac{\beta  \sqrt{4 \alpha +\beta ^2-2 \beta +1}}{\alpha }-\frac{\beta }{\alpha }\right)),\
(x<em>2,y</em>2)&amp;=(\frac{\sqrt{4 \alpha +\beta ^2-2 \beta +1}+\beta -1}{2 \alpha },\frac{1}{2} \left(\frac{\beta ^2}{\alpha }+\frac{\beta  \sqrt{4 \alpha +\beta ^2-2 \beta +1}}{\alpha }-\frac{\beta }{\alpha }\right)), \end{aligned}</p><pre><code class="nohighlight hljs">
Let&#39;s calculate the eigenvalues of these two fixed points under the classical parameters $\alpha=1.4,\beta=0.3$:
</code></pre><p>@example smooth_one using StaticArrays, LinearAlgebra function fixedpoints(p)     a , b = p     x1 = (-sqrt(4 * a + b^2 - 2 * b + 1) + b - 1) / (2 * a)     y1 = (1 / 2) * (b^2 / a - b * sqrt(4 * a + b^2 - 2 * b + 1) / a - b / a)     x2 = (sqrt(4 * a + b^2 - 2 * b + 1) + b - 1) / (2 * a)     y2 = (1 / 2) * (b^2 / a + b * sqrt(4 * a + b^2 - 2 * b + 1) / a - b / a)     return SA[x1, y1], SA[x2, y2] end</p><p>function jacobian(x, p)     a, b = p     J = @SMatrix [-2 * a * x[1] 1.0; b 0.0]     return J end</p><pre><code class="nohighlight hljs"></code></pre><p>@repl smooth_one eigen(jacobian(fixedpoints([1.4, 0.3])[1], [1.4, 0.3]))</p><pre><code class="nohighlight hljs"></code></pre><p>@repl smooth_one eigen(jacobian(fixedpoints([1.4, 0.3])[2], [1.4, 0.3]))</p><pre><code class="nohighlight hljs">
As we can see, under the classical parameters, both fixed points are unstable. Next, we&#39;ll use the InvariantManifolds.jl package to compute one branch of the unstable manifold of the second fixed point.

The InvariantManifolds.jl package has an interface similar to many Julia packages. First, we need to load the package in Julia and define the Henon map:
</code></pre><p>@repl smooth_one using InvariantManifolds function henonmap(x, p)     y1 = 1 - p[1] * x[1]^2 + x[2]     y2 = p[2] * x[1]     SA[y1, y2] end</p><pre><code class="nohighlight hljs">
Since the unstable eigenvalue at the saddle point is:</code></pre><p>@repl smooth_one eigen(jacobian(fixedpoints([1.4, 0.3])[2], [1.4, 0.3])).values[1]</p><pre><code class="nohighlight hljs">We need to iterate this mapping twice to ensure the manifold doesn&#39;t reverse during extension:
</code></pre><p>@repl smooth_one henonmap2(x, p)=henonmap(henonmap(x, p), p)</p><pre><code class="nohighlight hljs">
Now let&#39;s define a problem for computing a one-dimensional manifold of the smooth mapping:
</code></pre><p>@repl smooth_one para = [1.4, 0.3] prob = OneDManifoldProblem(henonmap2, para)</p><pre><code class="nohighlight hljs">
To compute the manifold, we need a small local manifold segment starting at the saddle point. Usually, an unstable eigenvector starting at the saddle point with a very small length will suffice. InvariantManifolds.jl provides a function [`gen_segment`](@ref) to generate such a local manifold:
</code></pre><p>@example smooth<em>one saddle = fixedpoints(para)[2] unstable</em>direction = eigen(jacobian(fixedpoints([1.4, 0.3])[2], [1.4, 0.3])).vectors[:,1] segment = gen<em>segment(saddle, unstable</em>direction)</p><pre><code class="nohighlight hljs">
Under default keyword arguments, this function will generate a local manifold starting at the saddle point, with a length of 150 units and a step size of 0.01. Now let&#39;s use this local manifold to compute the smooth manifold:
</code></pre><p>@repl smooth_one manifold = growmanifold(prob, segment, 8)</p><pre><code class="nohighlight hljs">
This package doesn&#39;t provide plotting functionality. However, since the computation results are stored in `manifold.data`, and `manifold.data` is actually a vector whose elements are interpolation functions from the [DataInterpolations.jl](https://github.com/SciML/DataInterpolations.jl) package:</code></pre><p>@repl smooth_one manifold.data</p><pre><code class="nohighlight hljs">
Therefore, we can define the following function to plot the smooth manifold:
</code></pre><p>@example smooth<em>one using CairoMakie function manifold</em>plot(data)     figure = Figure()     axes = Axis(figure[1,1])     for k in eachindex(data)         points = data[k].u         lines!(axes, first.(points), last.(points))     end     figure end manifold_plot(manifold.data)</p><pre><code class="nohighlight hljs">
## Oscillator with Periodic Forcing

Now let&#39;s consider a higher-order example. Consider the following oscillator with periodic forcing:</code></pre><p>math \begin{aligned} \dot{x}&amp;=y,\
\dot{y}&amp;=x-\delta x^3+\gamma \cos(\omega t). \end{aligned}</p><pre><code class="nohighlight hljs">
When $\gamma=0$, the system has a saddle point at $(0,0)$. After a small periodic perturbation, this saddle point becomes a saddle periodic orbit, which is a saddle point of the mapping $T:X\mapsto \phi(X,2\pi/\omega,0)$, where $\phi(X,t,t_0)$ is the solution of the system under the initial condition $X(t_0)=X\in\mathbb{R}^2$. Fortunately, we can obtain the Jacobian matrix of the mapping $T$ using the solution of the variational equation. The saddle point position and unstable direction of the mapping $T$ can also be obtained through numerical methods.

InvariantManifolds.jl provides a function [`findsaddle`](@ref) to obtain the saddle point position and unstable direction of $T$. Here&#39;s the code demonstrating how to use this function:
</code></pre><p>@example smooth<em>one using InvariantManifolds, LinearAlgebra, StaticArrays, OrdinaryDiffEq, CairoMakie f(x, p, t) = SA[x[2], x[1] - p[1]<em>(x[1]^3) + p[2]</em>cos(p[3]<em>t)] df(x, p, t) = SA[0.0 1.0; 1-p[1]</em>3*(x[1]^2) 0.0] initial</em>guess = SA[0.0, 0.0] para = [1.0, 0.1, 2.2] timespan = (0.0, 2pi/para[3]) saddle = findsaddle(f, df, timespan, initial_guess, para)</p><pre><code class="nohighlight hljs">
The `gen_segment` function can act directly on the [`Saddle`](@ref) structure. Therefore, we can use the following code to generate a local manifold:</code></pre><p>@repl smooth<em>one segment = gen</em>segment(saddle)</p><pre><code class="nohighlight hljs">
Now we can define the nonlinear mapping:</code></pre><p>@repl smooth_one function timeTmap(x, p)     prob = ODEProblem{false}(f, x, (0.0, 2pi/p[3]), p)     solve(prob, Vern9(), abstol=1e-10)[end] end</p><pre><code class="nohighlight hljs">
Then create the problem and solve it:</code></pre><p>@repl smooth_one prob = OneDManifoldProblem(timeTmap, para) manifold = growmanifold(prob, segment, 7)</p><pre><code class="nohighlight hljs">Finally, use the function defined in the previous section to plot the results:</code></pre><p>@example smooth<em>one manifold</em>plot(manifold.data) ```</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« 主页</a><a class="docs-footer-nextpage" href="../smooth_two/">光滑两维流形 »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Saturday 1 March 2025 03:48">Saturday 1 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
